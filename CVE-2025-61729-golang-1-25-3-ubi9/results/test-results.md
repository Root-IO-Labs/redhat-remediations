# CVE-2025-61729 Test Results - UBI 9

## Test Configuration

- **Date**: 2026-01-13
- **Number of SANs**: 5000
- **Target**: UBI 9 (Red Hat Universal Base Image 9)
- **Go Version**: 1.25.3-1.el9_7

---

## Summary

| Environment | Go Version | DNS SANs Test | IP SANs Test | Status |
|-------------|------------|---------------|--------------|--------|
| UBI 9 Unpatched | 1.25.3-1.el9_7 | VULNERABLE | VULNERABLE | ❌ |
| UBI 9 Patched | 1.25.3-1.el9 | PATCHED | PATCHED | ✅ |

---

## Detailed Results

### UBI 9 Unpatched (Base from repos)

```
Go Version: go1.25.3 (Red Hat 1.25.3-1.el9_7)
Testing with 5000 SANs

--- Test 1: Certificate with many DNS SANs ---
Generated certificate with 5000 DNS names
Time elapsed: 1.372867ms
Memory allocated: 949,544 bytes
Error message length: 108,939 (VULNERABLE - all SANs included)
RESULT: VULNERABLE ✗

--- Test 2: Certificate with many IP SANs ---
Generated certificate with 5000 IP addresses
Time elapsed: 43.185679ms
Memory allocated: 319,021,416 bytes (~319 MB)
Error message length: 60,286 (VULNERABLE - all IPs included)
RESULT: VULNERABLE ✗
```

### UBI 9 Patched (Custom RPMs)

```
Go Version: go1.25.3 (Red Hat 1.25.3-1.el9)
Testing with 5000 SANs

--- Test 1: Certificate with many DNS SANs ---
Generated certificate with 5000 DNS names
Time elapsed: 1.230181ms
Memory allocated: 721,872 bytes
Error message length: 74 (PATCHED - message truncated)
RESULT: PATCHED ✓

--- Test 2: Certificate with many IP SANs ---
Generated certificate with 5000 IP addresses
Time elapsed: 49.35µs
Memory allocated: 1,728 bytes
Error message length: 73 (PATCHED - message truncated)
RESULT: PATCHED ✓
```

---

## Performance Comparison

| Metric | Unpatched | Patched | Improvement |
|--------|-----------|---------|-------------|
| IP SANs Time | 43.19ms | 49.35µs | **~875x faster** |
| IP SANs Memory | 319 MB | 1.7 KB | **~187,000x less** |
| Error Msg Length | 60,286 bytes | 73 bytes | **~825x smaller** |

---

## Conclusion

The CVE-2025-61729 patch successfully mitigates the resource exhaustion vulnerability in UBI 9's golang package:

1. **Vulnerability Confirmed**: The base golang package (1.25.3-1.el9_7) from Red Hat repos is VULNERABLE
2. **Fix Verified**: Our patched RPMs successfully fix the vulnerability
3. **Performance**: Significant improvement in time and memory usage with the patch

---

## Reproduction Steps

```bash
# From the CVE-2025-61729-ubi9 directory

# Run all tests
./scripts/run-poc.sh --all

# Run only the patched test
./scripts/run-poc.sh --ubi9-patched

# Run with custom number of SANs
./scripts/run-poc.sh --all --sans 10000
```
