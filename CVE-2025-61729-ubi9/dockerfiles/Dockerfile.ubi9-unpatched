# CVE-2025-61729 POC Test - UBI 9 (Unpatched/Base)
#
# This tests the base golang package from Red Hat repos (vulnerable).
#
# Build: docker build -f dockerfiles/Dockerfile.ubi9-unpatched -t cve-poc-ubi9-unpatched .
# Run:   docker run --rm -e NUM_SANS=5000 cve-poc-ubi9-unpatched

FROM registry.access.redhat.com/ubi9/ubi

LABEL description="CVE-2025-61729 POC - UBI 9 Unpatched"
LABEL cve="CVE-2025-61729"
LABEL target="UBI 9 Unpatched (Base)"

# Install golang from base repos (vulnerable version)
RUN dnf -y update && \
    dnf -y install golang && \
    dnf -y clean all

# Verify golang is installed
RUN go version

# Copy POC code
WORKDIR /poc
COPY poc/ .

# Build the POC
RUN go build -o cve-poc .

# Set default number of SANs for testing
ENV NUM_SANS=5000

CMD ["./cve-poc"]
