# CVE-2025-14174 Analysis Report

## Package Information

| Field | Value |
|-------|-------|
| **CVE ID** | CVE-2025-14174 |
| **Package** | webkit2gtk3 |
| **Analyzed Version** | 2.50.4-1.el9_7 |
| **Platform** | Red Hat Enterprise Linux 9 |
| **CVSS Score** | 8.8 (HIGH) |
| **CWE** | CWE-787 (Out-of-bounds Write) |
| **Analysis Date** | 2026-01-17 |

---

## Conclusion

| Question | Answer |
|----------|--------|
| **Is RHEL9 webkit2gtk3 affected?** | **NO** |
| **Reason** | Vulnerable Metal backend code is not compiled for Linux |
| **Action Required** | None - no patch needed |

---

## Vulnerability Overview

CVE-2025-14174 is an out-of-bounds memory access vulnerability in **ANGLE's Metal renderer backend**.

- **Affected Component**: `pixelsDepthPitch` buffer handling in `TextureMtl.mm`
- **Attack Vector**: Crafted HTML page with malicious WebGL content
- **Root Cause**: Buffer size miscalculation using `GL_UNPACK_IMAGE_HEIGHT`

**Metal is Apple's graphics API** - it only exists on macOS/iOS platforms.

---

## Evidence

### 1. Vulnerable Code Found in Source

```
$ grep -r 'pixelsDepthPitch' webkitgtk-2.50.4/Source/ThirdParty/ANGLE/

Source/ThirdParty/ANGLE/src/libANGLE/renderer/metal/TextureMtl.h:
    size_t pixelsDepthPitch,
```

**Location**: `Source/ThirdParty/ANGLE/src/libANGLE/renderer/metal/TextureMtl.h`

The vulnerable code exists in the source tarball.

### 2. Metal Backend NOT Compiled for Linux

From `Source/ThirdParty/ANGLE/PlatformGTK.cmake`:

```cmake
list(APPEND ANGLE_DEFINITIONS 
    ANGLE_PLATFORM_LINUX 
    EGL_NO_PLATFORM_SPECIFIC_TYPES 
    USE_SYSTEM_EGL
)

list(APPEND ANGLE_DEFINITIONS
    ANGLE_ENABLE_OPENGL      # <-- Only OpenGL enabled
)
```

**`ANGLE_ENABLE_METAL` is NOT defined** for GTK/Linux builds.

### 3. Metal Code Uses Conditional Compilation

From `Source/ThirdParty/ANGLE/src/libANGLE/Display.cpp`:

```cpp
#if defined(ANGLE_ENABLE_METAL)
    // Metal renderer code - EXCLUDED on Linux
#endif
```

Since `ANGLE_ENABLE_METAL` is undefined, all Metal code is excluded at compile time.

### 4. Metal Files Cannot Compile on Linux

Metal renderer files use `.mm` extension (Objective-C++):
- `TextureMtl.mm`
- `BufferMtl.mm`
- `ContextMtl.mm`

These require Apple's Objective-C runtime and Metal framework, which do not exist on Linux.

---

## Summary

| Check | Result |
|-------|--------|
| Vulnerable code in source? | Yes |
| `ANGLE_ENABLE_METAL` defined for Linux? | No |
| Metal sources included in Linux build? | No |
| Metal files compilable on Linux? | No |
| **Vulnerable code in compiled binary?** | **No** |

---

## Platform Comparison

| Platform | ANGLE Backend | CVE-2025-14174 Status |
|----------|---------------|----------------------|
| macOS | Metal | Affected |
| iOS | Metal | Affected |
| Linux/GTK | OpenGL | **Not Affected** |
| Windows | Direct3D | Unknown |

---

## PoC Testing

### Why PoC is Not Possible on RHEL

The vulnerable code path **does not exist** in the compiled `libwebkit2gtk` on Linux. You cannot trigger a vulnerability that isn't present in the binary.

### Verification Commands (RHEL9)

To confirm Metal backend is absent:

```bash
# Check for Metal symbols (expect: 0 results)
nm -D /usr/lib64/libwebkit2gtk-4.0.so.37 2>/dev/null | grep -ci metal

# Verify OpenGL backend is used (expect: EGL/GL references)
ldd /usr/lib64/libwebkit2gtk-4.0.so.37 | grep -iE "GL|EGL"
```

### To Test CVE-2025-14174 (Requires Apple Platform)

| Requirement | Details |
|-------------|---------|
| Platform | macOS or iOS |
| Browser | Chrome < 143.0.7499.110 or Safari < 18.7.3 |
| Payload | WebGL with malformed `GL_UNPACK_IMAGE_HEIGHT` texture upload |

---

## Red Hat Advisory Status

| Source | Status |
|--------|--------|
| Red Hat RHSA | None issued |
| Red Hat Bugzilla | [Bug 2421824](https://bugzilla.redhat.com/show_bug.cgi?id=2421824) (tracking) |

Red Hat has not issued an advisory because Linux builds are not affected.

---

## Files Analyzed

| File | Finding |
|------|---------|
| `webkit2gtk3.spec` | Confirms `bundled(angle)` |
| `PlatformGTK.cmake` | Shows `ANGLE_ENABLE_OPENGL` only |
| `Metal.cmake` | Lists Metal sources (not used on Linux) |
| `TextureMtl.h` | Contains vulnerable `pixelsDepthPitch` |

---

## References

| Resource | Link |
|----------|------|
| NVD | https://nvd.nist.gov/vuln/detail/CVE-2025-14174 |
| Red Hat Bugzilla | https://bugzilla.redhat.com/show_bug.cgi?id=2421824 |
| CISA KEV | https://www.cisa.gov/known-exploited-vulnerabilities-catalog |
