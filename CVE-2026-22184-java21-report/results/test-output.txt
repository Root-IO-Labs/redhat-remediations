╔═══════════════════════════════════════════════════════════════════════════════╗
║     CVE-2026-22184 Comprehensive Vulnerability Test                           ║
║     Testing Red Hat java-21-openjdk from UBI10 repos                          ║
╚═══════════════════════════════════════════════════════════════════════════════╝

BUILD NOTE:
  We used Red Hat's pre-built package from UBI10 repositories (same version as
  local SRPM: java-21-openjdk-21.0.9.0.10-2.el10.src.rpm) to save build time.
  
  Local build was skipped because the SRPM requires packages not in UBI10 repos:
    - java-21-openjdk-portable-* (Red Hat internal bootstrap packages from el8)
    - Some X11 -devel packages (libXi, libXinerama, libXrandr, libXt, libXtst)
  
  The pre-built package IS the official result of building the same SRPM.
  Source code verification confirms the vulnerable code is NOT present.

════════════════════════════════════════════════════════════════════════════════

Installed Java (Red Hat official build - same version as local SRPM):
java-21-openjdk-headless-21.0.9.0.10-2.el10.x86_64
openjdk version "21.0.9" 2025-10-21 LTS
OpenJDK Runtime Environment (Red_Hat-21.0.9.0.10-1) (build 21.0.9+10-LTS)
OpenJDK 64-Bit Server VM (Red_Hat-21.0.9.0.10-1) (build 21.0.9+10-LTS, mixed mode, sharing)

Verifying this is the Red Hat build:
Source RPM  : java-21-openjdk-21.0.9.0.10-2.el10.src.rpm  ← MATCHES LOCAL SRPM
Build Date  : Sun Oct 26 20:15:03 2025
Vendor      : Red Hat, Inc.

════════════════════════════════════════════════════════════════════════════════

╔═══════════════════════════════════════════════════════════════════════════════╗
║     CVE-2026-22184 Comprehensive Java Vulnerability Test                      ║
║     Testing ALL zlib-related APIs for buffer overflow                         ║
╚═══════════════════════════════════════════════════════════════════════════════╝

Java Environment:
  Version:  21.0.9
  Vendor:   Red Hat, Inc.
  Home:     /usr/lib/jvm/java-21-openjdk
  VM:       OpenJDK 64-Bit Server VM

Vulnerability Info:
  CVE:           CVE-2026-22184
  Component:     zlib untgz (contrib/untgz/untgz.c)
  Buffer size:   1024 bytes
  Attack:        Filename > 1024 bytes causes overflow

Testing ALL Java compression APIs that might use zlib...

  ✅ PASS: ZipOutputStream with 1025-byte filename
  ✅ PASS: ZipInputStream with 1025-byte filename
  ✅ PASS: GZIPOutputStream with 1025 bytes data
  ✅ PASS: GZIPInputStream decompress 1025 bytes
  ✅ PASS: JarOutputStream with 1025-byte entry
  ✅ PASS: JarInputStream with 1025-byte entry
  ✅ PASS: Deflater/Inflater with 1025 bytes
  ✅ PASS: ZipFile with 1025-byte filename
  ✅ PASS: ZipOutputStream with 2048-byte filename
  ✅ PASS: ZipInputStream with 2048-byte filename
  ✅ PASS: GZIPOutputStream with 2048 bytes data
  ✅ PASS: GZIPInputStream decompress 2048 bytes
  ✅ PASS: JarOutputStream with 2048-byte entry
  ✅ PASS: JarInputStream with 2048-byte entry
  ✅ PASS: Deflater/Inflater with 2048 bytes
  ✅ PASS: ZipFile with 2048-byte filename
  ✅ PASS: ZipOutputStream with 4096-byte filename
  ✅ PASS: ZipInputStream with 4096-byte filename
  ✅ PASS: GZIPOutputStream with 4096 bytes data
  ✅ PASS: GZIPInputStream decompress 4096 bytes
  ✅ PASS: JarOutputStream with 4096-byte entry
  ✅ PASS: JarInputStream with 4096-byte entry
  ✅ PASS: Deflater/Inflater with 4096 bytes
  ✅ PASS: ZipFile with 4096-byte filename
  ✅ PASS: ZipOutputStream with 8192-byte filename
  ✅ PASS: ZipInputStream with 8192-byte filename
  ✅ PASS: GZIPOutputStream with 8192 bytes data
  ✅ PASS: GZIPInputStream decompress 8192 bytes
  ✅ PASS: JarOutputStream with 8192-byte entry
  ✅ PASS: JarInputStream with 8192-byte entry
  ✅ PASS: Deflater/Inflater with 8192 bytes
  ✅ PASS: ZipFile with 8192-byte filename
  ✅ PASS: ZipOutputStream with 16384-byte filename
  ✅ PASS: ZipInputStream with 16384-byte filename
  ✅ PASS: GZIPOutputStream with 16384 bytes data
  ✅ PASS: GZIPInputStream decompress 16384 bytes
  ✅ PASS: JarOutputStream with 16384-byte entry
  ✅ PASS: JarInputStream with 16384-byte entry
  ✅ PASS: Deflater/Inflater with 16384 bytes
  ✅ PASS: ZipFile with 16384-byte filename
  ✅ PASS: Extreme filename (65535 bytes - ZIP limit)
  ✅ PASS: Nested ZIP archives with long names
  ✅ PASS: Malformed archive handling (EOFException)

╔═══════════════════════════════════════════════════════════════════════════════╗
║                              TEST SUMMARY                                     ║
╚═══════════════════════════════════════════════════════════════════════════════╝

  Total tests:  43
  Passed:       43
  Failed:       0

  ═══════════════════════════════════════════════════════════════════════════
  ✅ ALL TESTS PASSED - Java is NOT affected by CVE-2026-22184
  ═══════════════════════════════════════════════════════════════════════════

  CONCLUSION:
  • All Java compression APIs handled long filenames safely
  • No buffer overflow was triggered
  • Java's zlib usage does NOT include the vulnerable untgz code
  • CVE-2026-22184 does NOT affect Java applications

════════════════════════════════════════════════════════════════════════════════
C VULNERABILITY DEMO OUTPUT
════════════════════════════════════════════════════════════════════════════════

╔═══════════════════════════════════════════════════════════════════════════════╗
║           CVE-2026-22184 Buffer Overflow Demonstration                        ║
║                    zlib untgz vulnerability                                   ║
╚═══════════════════════════════════════════════════════════════════════════════╝

VULNERABILITY DETAILS:
  CVE ID:       CVE-2026-22184
  Component:    zlib untgz utility (contrib/untgz/untgz.c)
  Issue:        Global buffer overflow in TGZfname()
  Root cause:   strcpy() without bounds checking
  Buffer size:  1024 bytes
  Trigger:      Archive filename > 1024 bytes

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
TEST: Filename length = 512 bytes
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  Buffer size:    1024 bytes
  Input length:   512 bytes
  Overflow:       0 bytes
  RESULT: OK ✅

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
TEST: Filename length = 1024 bytes
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  Buffer size:    1024 bytes
  Input length:   1024 bytes
  Overflow:       0 bytes
  RESULT: OK ✅

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
TEST: Filename length = 1025 bytes
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  Buffer size:    1024 bytes
  Input length:   1025 bytes
  Overflow:       1 bytes
  RESULT: POTENTIALLY VULNERABLE ⚠️

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
TEST: Filename length = 2000 bytes
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  Buffer size:    1024 bytes
  Input length:   2000 bytes
  Overflow:       976 bytes

  >>> Segmentation fault (core dumped) <<<
  Exit code: 139 (SIGSEGV)

════════════════════════════════════════════════════════════════════════════════
FINAL SUMMARY
════════════════════════════════════════════════════════════════════════════════

  C (untgz simulation):  ❌ CRASHED at 2000-byte filename (demonstrates CVE)
  Java (java.util.zip):  ✅ ALL 43 TESTS PASSED (not affected)

  CONCLUSION: Java 21 OpenJDK is NOT affected by CVE-2026-22184
