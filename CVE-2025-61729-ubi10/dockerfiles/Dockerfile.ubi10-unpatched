# CVE-2025-61729 POC Test - UBI 10 (Unpatched/Base)
#
# This tests the base golang package from UBI 10 repositories
# WITHOUT the CVE fix applied.
#
# Build: docker build -f dockerfiles/Dockerfile.ubi10-unpatched -t cve-poc-ubi10-unpatched .
# Run:   docker run --rm -e NUM_SANS=5000 cve-poc-ubi10-unpatched

FROM registry.access.redhat.com/ubi10/ubi

LABEL description="CVE-2025-61729 POC - UBI 10 Unpatched"
LABEL cve="CVE-2025-61729"
LABEL target="UBI 10 Base (Unpatched)"

# Install golang from UBI 10 repos (base version)
RUN dnf -y update && \
    dnf -y install golang && \
    dnf -y clean all

# Copy POC code
WORKDIR /poc
COPY poc/ .

# Build the POC
RUN go build -o cve-poc .

# Set default number of SANs for testing
ENV NUM_SANS=5000

CMD ["./cve-poc"]
